<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Update Book</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
      crossorigin="anonymous"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
    ></script>
  </head>
  <body>
     <nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
      <a class="navbar-brand" href="/">CRUD</a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent" class="d-flex align-items-center">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/books">Books</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/authors">Author</a>
          </li>
        </ul> 
 {{#if isAuthenticated}}
  <p class="m-2 me-4" style="color: gray;">Welcome, {{user.email}}</p>
  <a href="/logout" class="btn btn-primary btn-sm mx-1">Logout</a>
{{else}}
  <a href="/login" class="btn btn-primary btn-sm mx-1">Login</a>
  <a href="/register" class="btn btn-primary btn-sm mx-1">Register</a>
{{/if}}
    </div>
    </div>
  </nav>
    <div class="w-100 h-75 d-flex justify-content-center ">

      <form action="/books/update" method="POST" class="mt-4 w-50 row g-3" id="validation" novalidate>

<div class="w-100 d-flex justify-content-between align-items-center">
  <h2>Edit Book</h2>
  <a href="/books" class="btn btn-primary btn-sm mt-1">
    <i class="fas fa-arrow-left" style="color: #f5f5f5;"></i> BACK
  </a>
</div>
<h5 class="mt-2">ID : {{book.id}}</h5>
     <div class="mb-3 mt-2">
       <label class="form-label ">Title * </label>
       <input type="text" class="form-control" name="title" value="{{book.title}}" required>
       <div class="invalid-feedback">
         Please fill in the title.
       </div>
       <div class="valid-feedback">
         Looks good!
       </div>
     </div>
     <div class="mb-3">
       <label  class="form-label ">Author *</label>
      <!--  <input type="text" class="form-control" name="author" pattern="[A-Za-z\s]+" value="{{book.author}}" required> -->
      <select class="form-select form-control" name="author" aria-label="Default select example" required>
  <option value="{{author.id}}" selected >{{author.name}}</option>
  {{#each authors}}
  <option value="{{this.id}}">{{this.name}}</option>
  {{/each}}
</select>
       <div class="invalid-feedback">
        Please enter a valid author name without numbers.
       </div>
       <div class="valid-feedback">
         Looks good!
       </div>
     </div>
     <div class="w-50">
       <label  class="form-label ">Pages *</label>
       <input type="number" class="form-control" name="pages" min="1" value="{{book.pages}}" required>
       <div class="invalid-feedback">
         Please provide the number of pages.
       </div>
       <div class="valid-feedback">
         Looks good!
       </div>
     </div>
     <div class="w-50">
       <label  class="form-label ">Prize *</label>
       <input type="number" class="form-control" name="prize" min="0" value="{{book.prize}}" required>
       <div class="invalid-feedback">
         Please provide the prize.
       </div>
       <div class="valid-feedback">
         Looks good!
       </div>
     </div>
     <div class="mb-3">
       <label  class="form-label">Info</label>
        <textarea class="form-control" name="info" >{{book.info}}</textarea>
     </div>
       <input type="hidden" name="id" value="{{book.id}}">
     <div class="col-12">
       <button class="btn btn-primary" type="submit">Update Book</button>
     </div>
   </form>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
      crossorigin="anonymous"
    ></script>
    <script src="https://kit.fontawesome.com/9d7dbeda4d.js" crossorigin="anonymous"></script>
    <script>
   
    $(document).ready(function() {
      const form = document.querySelector('#validation');
      form.addEventListener('submit', function(event) {
        if (!form.checkValidity()) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      });
     });
    </script>
  </body>
</html>
